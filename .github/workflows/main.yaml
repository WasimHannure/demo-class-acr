name: Push Image to ACR

on:
  workflow_dispatch:
jobs:
  build:
   runs-on: ubuntu:latest
   defaults:
    run: 
     shell: bash
   steps:
   - name: Checkout the repository
   - uses: actions/checkout@v2

   - name: Azure Login
   - uses: Azure/docker-login@v1
     with:
       login-server: demopush.azurecr.io
       username: ${{ secrets.ACR_USERNAME }}
       password: ${{ secrets.ACR_PASSWORD }}
   - name: Build and Push docker images to ACR
   - run:
      docker build -t demopush.azurecr.io/pythonapp:${{ github.sha }}
      docker push demopush.azurecr.io/pythonapp:${{ github.sha }}
      
